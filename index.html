<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Top Oyunu</title>
	<style>
		body{
			padding:0;
			margin:0;
			overflow: hidden;
		}
	</style>
</head>
<body>
<canvas id="canvas"></canvas>

<script type="text/javascript">
//canvas animasyonu için gerekli kod
//canvas çizim fonksiyonu için gereken isteği 1 saniyede (1000ms'te) 60 kere gönder (60fps için)
window.animasyonFrameIstegi = (function(){

	return window.requestAnimationFrame || window.webkitRequestAnimationFrame || window.mozRequestAnimationFrame || window.oRequestAnimationFrame || window.msRequestAnimationFrame || function ( callback ){
		return window.setTimeout(callback, 1000 / 60);
		};
})();

//canvas değişkeni

var canvas = document.getElementById("canvas"),
	ctx    = canvas.getContext("2d"),//canvas context oluşturduk
	G      = window.innerWidth,//pencere genişliğinde oyun alanı genişliği
	Y      = window.innerHeight,//pencere yüksekliğinde oyun alanı yüksekliği
	mouse = {}, //mouse objesi
	parcalar = [], //top çubuğa çarptığında çıkacak parçacıklar için array
	topum = {}, //top nesnesi
	cubuk = [2]; //iki çubuk içerecek olan array

	//canvasın tam ekran olmasını sağladık
	canvas.width  = G;
	canvas.height = Y;

	//eventlistener ekleyelim (mouseun hareketini yakalamak(takip etmek) için)
	canvas.addEventListener("mousemove", mouseHareket, true); //mousemove olduğunda(fare hareket ettiğinde) bu hareketi parametre olarak mouseHareket fonksiyonuna gönder

	//top nesnesini tanımlayalım
	topum = {
		x:50, //x ekseninde başlangıç noktasının sola olan uzaklığı (pixel)
		y:50, //y ekseninde başlangıç noktasının yukarıya olan uzaklığı (pixel)
		r:5, //radius, topa yuvarlaklık (daire şekli) vermek için
		c:"white", //color, renk için beyaz tanımladık
		xh:4, //topun x eksenindeki hızının başlangıç değeri
		yh:8, //topun y eksenindeki hızının başlangıç değeri

		ciz: function (){
			ctx.beginPath();//çizime başlayacağımızı haber vermek için
			ctx.fillStyle = this.c;//nesnenin içini doldururken verilecek stil için (biz yukarıda tanımladığımız c değişkeninden gelen rengi atadık)
			ctx.arc(this.x, this.y, this.r, 0/*başlangıç trigonometrik açısı 0*/, Math.PI*2/*bitiş trigonometrik açısı 2PI yani 360*/, false/*saat yönüne doğru*/);//oluşturulacak topun kıvrımlarını ayarlıyoruz
			ctx.fill();//çiz(doldur)
		}
	};

	//çubuk için fonksiyon oluşturalım
	function Kurek(poz) {
		this.h = 5; //sadece BU(this) fonksiyon içinde çalışacak olan küreğin yüksekliğini belirten h değişkeni
		this.w = 150; //sadece BU(this) fonksiyonu içinde çalışacak olan küreğin genişliğini belirten w değişkeni

		//küreklerin(çubukların) pozisyonunu tanımlayalım
		this.x = G/2 - this.w/2;
		this.y = (poz == "ust") ? 0 : Y - this.h;
	}

	//cubuk arrayine kürekleri(çubukları) ekleyelim
	cubuk.push(new Kurek("asagi")); //burada anlamadığım bir şey var: Kurek bir fonksiyon, neden obje gibi new keywordü ile kullandık?
	cubuk.push(new Kurek("ust"));

	//tuval çizmek için gerekli fonksiyon
	//galiba artık daha düzgün bir yapıya gitmek için attığımız ilk adım (kişisel yorum)
	function canvasCiz(){
		ctx.fillStyle = "black";
		ctx.fillRect(0, 0, G, Y);
	};

	//her şeyi canvas bölgesinde (tuvalde) çizmek için gerekli fonksiyon
	function ciz(){
		canvasCiz(); //canvası çiz
		for(var i = 0; i<cubuk.length; i++){ //çubukları(kürekleri) çiz
			p = cubuk[i];
			ctx.fillStyle = "white";
			ctx.fillRect(p.x, p.y, p.w, p.h);
		}
		topum.ciz(); //topum nesnesi içindeki çiz fonksiyonu, şu an oluşturduğumuz çiz fonksiyonu değil
		guncelle(); //çubuğun, topun yeni konumlarını 1 saniyede 60 kez değiştirecek fonksiyon
	};

	//animasyonları çalıştırmak için oluşturduğumuz döngü
	function animDongu(){
		res = animasyonFrameIstegi(animDongu);//animasyon frame isteğini resetle
		ciz(); //her şeyi çiz
	};

	animDongu();

	//ekrandaki değişiklikleri güncelle fonksiyonu gösterecek (bu fonksiyon animDongu içinde yer aldığı için saniyede 60 kere çalışır)
	function guncelle(){
		//topu hareket ettiriyoruz
		//hız: birim zamanda(bizim örneğimizde bir saniyenin altmışta biri) alınan yol !!önemli!! yani saniyenin altmışta birinde ben mouseun x eksenindeki bulunduğu noktaya hız değerim olan 4 ü eklediğimde hızı 4 olmuş olur !! , her güncelleme işleminde topun hız miktarını bulunduğu noktaya ekleyerek yol almasını sağladık
		topum.x = topum.x + topum.xh;//topun x eksenindeki bulunduğu noktaya topun x eksenindeki hızını ekle
		topum.y = topum.y + topum.yh;

		//cubugu hareket ettiriyoruz
		if(mouse.x && mouse.y){ //mouse.x VE mouse.y TRUE ise yani değer barındırıyor ise
			for(var i = 1; i < cubuk.length; i++){ //iki çubuğa da erişebilmek için for açtık
				p = cubuk[i]; //çubuğun herhangi bir PARÇASI(p)
				p.x = mouse.x - p.w/2; //eğer p.x yani çubuğun x eksenindeki başlangıcı mouse.x ile aynı olsaydı, çubuk mouseu tuttuğumuz yerden başlardı, bu yüzden mouse.xten çubuğun genişliğinin yarısını çıkardık ki çubuğun başlangıç noktası çubuğun ortasına kaysın ve mouseu tuttuğumuz yerde çubuğun ortası olsun. !!ÖNEMLİ!!
			}
		}
	}

	//mouseumuzu hareket ettiriyoruz.
	function mouseHareket(e){ //eventlistenerdan gelen parametreyi al, parametrede içinde, mouseun sayfanın x ekseninde ettiği hareketi(pageX) mouse.x e ata, mouseun sayfanın y ekseninde ettiği hareketi(pageY) mouse.y ye ata
		mouse.x = e.pageX; 
		mouse.y = e.pageY;
	}

</script>
</body>
</html>